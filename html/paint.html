<!DOCTYPE html>
<html>

<head lang="en">
    <meta charset="UTF-8">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/6.1.1/d3.min.js"
        integrity="sha512-5xkNvFVCctXwOszeifE8pzjyDFlHvHDCKIrhwmuSbCtTHqc7IhA6/1tTNYXE8WmYvwP5KFQegCS1QRR4poYgjg=="
        crossorigin="anonymous"></script>

</head>

<body>
    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="500px"
        height="500px" id="panel"></svg>
    <button onclick="createRect()">rect</button>
    <div id="log1"></div>
    <div id="log2"></div>
    <div id="log3"></div>
    <script>
        var panel = document.querySelector('#panel');

        function createRect() {
            let ddd = new Rect(0, 0, panel);
            ddd.create();
        }


        class Drawing {
            getWidth() {
                return parseInt(this.getAttribute('width'));
            }
        }
        class Rect extends Drawing {
            svg;
            initX = 0;
            initY = 0;
            curX = 0;
            curY = 0;
            panel;
            isMdown = false;
            constructor(initX, initY, panel) {
                super();
                this.initX = initX;
                this.initY = initY;
                this.panel = panel;
            }
            create() {
                this.svg = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
                panel.appendChild(this.svg);
                this.svg.setAttribute('width', '300');
                this.svg.setAttribute('height', '200');
                this.svg.setAttribute('fill', 'red');
                this.svg.setAttribute('x', this.curX);
                this.svg.setAttribute('y', this.curY);

                this.svg.addEventListener('click', ()=> {console.log('clicked')});
                this.svg.addEventListener('mousedown', ()=> {
                    this.isMdown = true;
                });
                this.svg.addEventListener('mousemove', () => this.move());
                this.svg.addEventListener('mouseup', () => {
                    this.isMdown = false;
                });
            }

            move() {
                if(!this.isMdown) return;
                setLog('log1', event.x, event.y);
                console.log('mousemove', event.x);
                this.svg.setAttribute('x', event.x - this.svg.getAttribute('width') / 2);
                this.svg.setAttribute('y', event.y - this.svg.getAttribute('height') / 2);
            }
        }



        function setLog(id, ...text) {
            let strText = "";
            for (let i = 0; i < text.length; i++) {
                strText = strText + ", " + text[i];
            }
            document.querySelector('#' + id).textContent = strText.substr(1);
        }
    </script>
</body>

</html>